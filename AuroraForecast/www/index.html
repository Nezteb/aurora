<!DOCTYPE html>
<html style="width:100%;height:100%;overflow:hidden;margin:0px;padding:0px;">
	<head>
        <div id="test" style="display:none;"></div>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">

		<link rel="stylesheet" href="css/app.css">

		<script src="cordova.js" id="xdkJScordova_"></script>
		<script src="js/app.js"></script>
		<script src="js/init-app.js"></script>
		<script src="xdk/init-dev.js"></script>

		<script>
			//Since console.log() doesn't work...
			var div=document.getElementById("test");

			function logit(message)
			{
				//div.innerHTML+=message+"<br/>";
			}

			try
			{
                var id="209803454821";
				logit("started");
				logit("senderid="+id)
				document.addEventListener("deviceready",function()
				{
					try
					{
						logit("device ready");

						var push=window.PushNotification.init
						({
							"android":{"senderID":id},
							"ios":{"alert":"true","badge":"true","sound":"true"},
							"windows":{}
						});

						push.on('registration',function(data)
						{
							var str="registration="+JSON.stringify(data);
							logit(str);

							//Hack to get regid...
							var iframe=document.createElement("iframe");
                            iframe.style.display="none";
							iframe.src="http://aurora.cs.uaf.edu/"+str;
							div.appendChild(iframe);
							setTimeout(function(){div.removeChild(iframe);},1000);
						});

						push.on('notification',function(data)
						{
							logit("notification="+JSON.stringify(data));
						});
					}
					catch(error)
					{
						logit("Throw(deviceready: "+error);
					}
				});
			}
			catch(error)
			{
				logit("Throw: "+error);
			}
		</script>
	</head>

	<body style="width:100%;height:100%;overflow:hidden;margin:0px;padding:0px;">
		<iframe src="http://www.gi.alaska.edu/AuroraForecast" style="width:100%;height:100%;overflow:hidden;margin:0px;padding:0px;" frameBorder="0"></iframe>
	</body>
</html>